<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.17">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3d-Printed Microscopes – Introduction to the Raspberry Pi and Raspberry Pi Camera Module</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">3d-Printed Microscopes</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-labs" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Labs</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-labs">    
        <li>
    <a class="dropdown-item" href="../../labs/">
 <span class="dropdown-text">Labs Overview</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../labs/lab1/">
 <span class="dropdown-text">Lab 1: Hello World</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../labs/lab2/">
 <span class="dropdown-text">Lab 2: Intro to Ray Tracing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../labs/lab3/">
 <span class="dropdown-text">Lab 3: 3d-printed Microscope</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link active" data-scroll-target="#learning-objectives"><span class="header-section-number">1</span> Learning Objectives</a></li>
  <li><a href="#instructions" id="toc-instructions" class="nav-link" data-scroll-target="#instructions"><span class="header-section-number">2</span> Instructions</a>
  <ul class="collapse">
  <li><a href="#setup-raspberry-pi-zero-as-ethernet-gadget" id="toc-setup-raspberry-pi-zero-as-ethernet-gadget" class="nav-link" data-scroll-target="#setup-raspberry-pi-zero-as-ethernet-gadget"><span class="header-section-number">2.1</span> Setup Raspberry Pi Zero as Ethernet Gadget</a></li>
  <li><a href="#connecting-to-the-raspberry-pi-using-ssh" id="toc-connecting-to-the-raspberry-pi-using-ssh" class="nav-link" data-scroll-target="#connecting-to-the-raspberry-pi-using-ssh"><span class="header-section-number">2.2</span> Connecting to the Raspberry Pi Using SSH</a></li>
  <li><a href="#connecting-to-the-internet" id="toc-connecting-to-the-internet" class="nav-link" data-scroll-target="#connecting-to-the-internet"><span class="header-section-number">2.3</span> Connecting to the Internet</a></li>
  <li><a href="#connecting-to-wifi-directly" id="toc-connecting-to-wifi-directly" class="nav-link" data-scroll-target="#connecting-to-wifi-directly"><span class="header-section-number">2.4</span> Connecting to WiFi Directly</a></li>
  <li><a href="#sharing-internet-from-host-machine-over-usb" id="toc-sharing-internet-from-host-machine-over-usb" class="nav-link" data-scroll-target="#sharing-internet-from-host-machine-over-usb"><span class="header-section-number">2.5</span> Sharing Internet from Host Machine Over USB</a></li>
  <li><a href="#enable-and-setup-virtual-network-computing-vnc-interface" id="toc-enable-and-setup-virtual-network-computing-vnc-interface" class="nav-link" data-scroll-target="#enable-and-setup-virtual-network-computing-vnc-interface"><span class="header-section-number">2.6</span> Enable and Setup Virtual Network Computing (VNC) Interface</a></li>
  <li><a href="#setup-samba-share" id="toc-setup-samba-share" class="nav-link" data-scroll-target="#setup-samba-share"><span class="header-section-number">2.7</span> Setup Samba Share</a></li>
  <li><a href="#setting-up-python-virtual-environment" id="toc-setting-up-python-virtual-environment" class="nav-link" data-scroll-target="#setting-up-python-virtual-environment"><span class="header-section-number">2.8</span> Setting up Python Virtual Environment</a></li>
  <li><a href="#installing-the-camera" id="toc-installing-the-camera" class="nav-link" data-scroll-target="#installing-the-camera"><span class="header-section-number">2.9</span> Installing the Camera</a></li>
  <li><a href="#take-your-first-picture" id="toc-take-your-first-picture" class="nav-link" data-scroll-target="#take-your-first-picture"><span class="header-section-number">2.10</span> Take Your First Picture</a></li>
  <li><a href="#process-image-in-python" id="toc-process-image-in-python" class="nav-link" data-scroll-target="#process-image-in-python"><span class="header-section-number">2.11</span> Process Image in Python</a></li>
  </ul></li>
  <li><a href="#image-acquisition-and-analysis-experiments" id="toc-image-acquisition-and-analysis-experiments" class="nav-link" data-scroll-target="#image-acquisition-and-analysis-experiments"><span class="header-section-number">3</span> Image Acquisition and Analysis Experiments</a>
  <ul class="collapse">
  <li><a href="#image-with-scale-bar" id="toc-image-with-scale-bar" class="nav-link" data-scroll-target="#image-with-scale-bar"><span class="header-section-number">3.1</span> Image with Scale Bar</a></li>
  <li><a href="#raw-bayer-image-capture" id="toc-raw-bayer-image-capture" class="nav-link" data-scroll-target="#raw-bayer-image-capture"><span class="header-section-number">3.2</span> Raw Bayer Image Capture</a></li>
  <li><a href="#dark-noise-analysis" id="toc-dark-noise-analysis" class="nav-link" data-scroll-target="#dark-noise-analysis"><span class="header-section-number">3.3</span> Dark Noise Analysis</a></li>
  <li><a href="#image-intensity-vs.-exposure-time" id="toc-image-intensity-vs.-exposure-time" class="nav-link" data-scroll-target="#image-intensity-vs.-exposure-time"><span class="header-section-number">3.4</span> Image Intensity vs.&nbsp;Exposure Time</a></li>
  </ul></li>
  <li><a href="#faqs" id="toc-faqs" class="nav-link" data-scroll-target="#faqs"><span class="header-section-number">4</span> FAQs</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introduction to the Raspberry Pi and Raspberry Pi Camera Module</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="learning-objectives" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="learning-objectives"><span class="header-section-number">1</span> Learning Objectives</h2>
<p>By the end of this lab you will have…</p>
<ul>
<li>Set up an operating system on your Raspberry Pi and configured it for headless operation using ethernet over USB.</li>
<li>Set up file sharing between the Pi and your host computer using Samba to allow for data to be easily transferred between the two systems.</li>
<li>Set up Python in a virtual environment on your Pi to control data acquisition from the camera</li>
<li>Connected a Raspberry Pi camera to you Pi and taken a series of images using both the libcamera command line tool and the Python package picamera</li>
<li>Performed basic image processing and analysis of the captured images in Python</li>
</ul>
<p>Remember to track the time you spend on this assignment, as you will be asked to submit it along with your work.</p>
</section>
<section id="instructions" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="instructions"><span class="header-section-number">2</span> Instructions</h2>
<p>The first step is to get your Raspberry Pi set up. These labs will use the <a href="https://www.raspberrypi.com/products/raspberry-pi-zero-2-w/">Raspberry Pi Zero 2 W</a> and a <a href="https://www.raspberrypi.com/products/pi-noir-camera-v2/">Raspberry Pi Camera Module</a> (specifically the NoIR version which has the IR shortpass filter removed to enable capturing light from a wider range of optical wavelengths.) The Raspberry Pi will be used as an external peripheral and controlled over the command line with ssh and through VNC if you prefer to use a graphical user interface (GUI). Don’t fear if you don’t have experience with the command line, this lab will provide you with a basic tutorial so that you can get up and running.</p>
<p>This lab has a series of steps. First, you will follow the procedure to set up the Raspberry Pi as an Ethernet Gadget. This leverages a convenient feature of the Pi that enables ethernet connections over the USB port. This will allow us to connect to the Pi over an ssh connection in the terminal to control the operation of the Pi. We will also set up file sharing over this network connection so that you have an easy way to transfer data from the Pi where it is captured, to your host computer which has more processing power and a display to be able to analyze and process your captured data.</p>
<p>After setting up your Pi, you will walk through the process of installing your Raspberry Pi camera and learn how to take some test images with the <code>libcamera</code> command line tool. Following this, you will learn the basic features of <code>picamera</code>, the Python library that is used to interface with the camera. <code>picamera</code> gives you fine-grained control over the settings of the camera and offers the low-level control that is necessary for accessing the raw data captured by the sensor which is important for scientific applications like microscopy.</p>
<section id="setup-raspberry-pi-zero-as-ethernet-gadget" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="setup-raspberry-pi-zero-as-ethernet-gadget"><span class="header-section-number">2.1</span> Setup Raspberry Pi Zero as Ethernet Gadget</h3>
<section id="installing-the-operating-system" class="level4" data-number="2.1.1">
<h4 data-number="2.1.1" class="anchored" data-anchor-id="installing-the-operating-system"><span class="header-section-number">2.1.1</span> Installing the Operating System</h4>
<p>In this section, you will install an operating system on your Raspberry Pi and set it up so that you can control it in a headless configuration (i.e., without a dedicated external monitor) from your personal computer</p>
<p>If you don’t already have an SD card with an OS image installed, download the <a href="https://www.raspberrypi.org/software/">Raspberry Pi Imager</a> and install the operating system onto your SD card. Click the button to choose an operating system and select the <code>Raspberry Pi OS (32-bit)</code> option which will download the latest version of Debian Linux for the Raspberry Pi (called <code>Bullseye</code> at the time of writing this guide). Then click the <code>Choose Storage</code> button and select the SD card you connected to your computer. After choosing the SD card, click the <code>Write</code> button to install the operating system.</p>
<div id="fig-rpi-imager" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rpi-imager-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/rpi-imager.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rpi-imager-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Raspberry Pi Imager screenshot
</figcaption>
</figure>
</div>
</section>
<section id="configuring-the-os-for-headless-operation" class="level4" data-number="2.1.2">
<h4 data-number="2.1.2" class="anchored" data-anchor-id="configuring-the-os-for-headless-operation"><span class="header-section-number">2.1.2</span> Configuring the OS for Headless Operation</h4>
<p>After installing the OS, re-mount the SD card (most easily done by removing and then re-inserting the SD card). The new volume should be called “boot”. Next you will need to make a few changes to the files on the card to configure it for headless operation before continuing.</p>
<ol type="1">
<li>Open <code>config.txt</code> and append <code>dtoverlay=dwc2</code> in a new line at the end of the file.</li>
<li>Open a terminal window (<code>Terminal</code> on MacOS/Linux/Unix or <code>Powershell</code> on Windows) and create a new file. Navigate to the <code>boot</code> volume and create a new file called <code>ssh</code> with no file extension using either <code>touch ssh</code> on Unix or <code>echo &gt;&gt; ssh</code> on Windows. (You may also create a new file with a text editor like VS Code and save it with the name <code>ssh</code>, again without a file extension).</li>
<li>Finally, open the file called <code>cmdline.txt</code>, look for the text <code>rootwait</code> and add the following right after it <code>modules-load=dwc2,g_ether</code>. The formatting of cmdline.txt is very strict; commands are separated by spaces. Be sure not to add any additional newline characters.</li>
</ol>
<p>Now eject the SD card, install it in the Pi, and connect your Pi to your computer via USB using the port labeled USB (not PWR_IN!)</p>
</section>
</section>
<section id="connecting-to-the-raspberry-pi-using-ssh" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="connecting-to-the-raspberry-pi-using-ssh"><span class="header-section-number">2.2</span> Connecting to the Raspberry Pi Using SSH</h3>
<p>After connecting it to your computer, you should see the activity LED light up (note there is no power LED on the Pi Zero) and after it finishes booting, you should see the Pi show up as a new network interface with a self-assigned IP address.</p>
<p>We will be communicating with our Pi over ssh or Secure Shell. <a href="https://en.wikipedia.org/wiki/Secure_Shell">ssh</a> is a very popular cryptographic network protocol which is used to communicate securely over an unsecured network.</p>
<p>After you see the Pi get an IP address, you should be able to ssh into the Pi in terminal. Open your terminal emulator up again and type <code>ssh pi@raspberrypi.local</code> or <code>ssh pi@&lt;ip_addr&gt;</code> where <code>&lt;ip_addr&gt;</code> is the IP address you saw the Pi was assigned in the previous step. <code>raspberrypi.local</code> is a dynamic nameserver (DNS) shortcut which redirects to the IP for the Pi and is a handy shortcut to save you the step of looking up the actual assigned address.</p>
<p>After typing this command you should get a message back that the connection has been made and if it is the first time you ssh in, you will also get a prompt asking you to add the Pi to the list of known hosts. (Note: If you have ever sshed into a different rasperrypi.local device you may see an error about a duplicate in your ssh known_hosts. To fix this, navigate to the known_hosts file and remove the line corresponding to raspberrypi.local.)</p>
<p>You will then get a prompt for the password for the <code>pi</code> user which is <code>raspberry</code> by default. After entering it, you should see a message that you have been logged in. Using the default password is a security hazard, so the first thing you should do is set a new one. Enter <code>passwd</code> at the command line prompt and follow the prompts to set a new login password for the user <code>pi</code>.</p>
</section>
<section id="connecting-to-the-internet" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="connecting-to-the-internet"><span class="header-section-number">2.3</span> Connecting to the Internet</h3>
<p>There are two ways to connect to the Internet from the Pi. You may either connect directly to WiFi or you can share the Internet connection from your host computer. You may choose either option and follow the instructions below to set it up.</p>
</section>
<section id="connecting-to-wifi-directly" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="connecting-to-wifi-directly"><span class="header-section-number">2.4</span> Connecting to WiFi Directly</h3>
<p>To connect to WiFi directly, run <code>sudo raspi-config</code> and then navigate to <code>1 System Options &gt; S1 Wireless LAN</code> and enter your SSID and password to connect.</p>
</section>
<section id="sharing-internet-from-host-machine-over-usb" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="sharing-internet-from-host-machine-over-usb"><span class="header-section-number">2.5</span> Sharing Internet from Host Machine Over USB</h3>
<p>To get internet on your Pi we will share the network connection from your host machine over the USB connection. To do this, To do this, edit the <code>/etc/network/interfaces</code> file. You’ll need to edit it with sudo (i.e., admin) privileges. An easy way to do this is with the nano text editor. To open the file to edit, type <code>sudo nano /etc/network/interfaces</code> at your Pi’s command prompt (over ssh).</p>
<p>Modify the file to have the following contents</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup USB internet</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">auto</span> lo usb0 </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ex">allow-hotplug</span> usb0</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="ex">iface</span> usb0 inet manual</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>When you are finished, the file should look like this.</p>
<div id="fig-network-interfaces-file" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-network-interfaces-file-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/edited-hosts-file.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-network-interfaces-file-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Edited <code>/etc/network/interfaces/</code> file
</figcaption>
</figure>
</div>
<p>When you finish editing the file, exit out of the file saving changes using <code>ctrl + x</code> and then reboot your Pi by typing <code>sudo reboot</code>.</p>
<p>Now that the Pi is configured to connect to the internet over USB, you need to configure your host to share its internet connection. Follow the instructions <a href="https://learn.adafruit.com/turning-your-raspberry-pi-zero-into-a-usb-gadget/ethernet-tweaks#sharing-network-access-to-your-pi-2127626-6">here</a> to configure your host. After you configure it, test that it is working properly by trying to ping a website like google from your Pi (e.g., by running <code>ping google.com</code>) from the command line.</p>
<p>After setting up the internet connection, update your packages by running <code>sudo apt-get update</code> and responding <code>y</code> to any prompts.</p>
</section>
<section id="enable-and-setup-virtual-network-computing-vnc-interface" class="level3" data-number="2.6">
<h3 data-number="2.6" class="anchored" data-anchor-id="enable-and-setup-virtual-network-computing-vnc-interface"><span class="header-section-number">2.6</span> Enable and Setup Virtual Network Computing (VNC) Interface</h3>
<p>To enable the VNC interface, first run the raspi-config tool by typing <code>sudo raspi-config</code> at the prompt on your Pi. Then navigate to option <code>3 Interface Options</code> and select option <code>I3 VNC</code>. Make sure that <code>&lt;Yes&gt;</code> is selected. After exiting the raspi-config interface you may need to reboot to see changes take effect (you can do so by typing <code>sudo reboot</code>.</p>
<p>You will also need to install a VNC viewer on your host computer. A popular free option is VNC Viewer from RealVNC available for download <a href="https://www.realvnc.com/en/connect/download/viewer/">here</a>.</p>
<p>After downloading VNC Viewer and enabling VNC on your Pi, you can connect to a virtual desktop. Open VNC Viewer and type the IP address of your Pi (e.g., raspberrypi.local) in the address bar at the top of the window. Press enter and you should see a window showing the Raspberry Pi desktop.</p>
<p>While you are configuring the VNC, you should also configure the VNC server to enable direct capture mode. This is important for viewing some windows (the libcamera preview window is one important example) over VNC. To do this, on the Raspberry Pi desktop click on VNC icon in the top right of the menubar. Then click on the icon with 3 horizontal bars at the top right of the VNC Server window and select <code>Options</code>. In the options window, select <code>Troubleshooting</code> and then check the checkbox <code>Enable direct capture mode</code>. Click OK to apply the changes and close the window.</p>
<p>You may also want to configure the VNC resolution if it does not look as you wish on your host. You can change these settings in the raspi-config utility under menu option <code>2 Display Options</code>.</p>
</section>
<section id="setup-samba-share" class="level3" data-number="2.7">
<h3 data-number="2.7" class="anchored" data-anchor-id="setup-samba-share"><span class="header-section-number">2.7</span> Setup Samba Share</h3>
<p>Next we will configure Server Message Block (SMB) or Samba file sharing from the Pi. This will enable you to share a folder on the Raspberry Pi so that you can easily transfer data between the Pi and your host computer using a file browser such as Finder on MacOS or Explorer on Windows.</p>
<p>To set up the sharing, we will use the aptitude package manager <code>apt</code>. The first step is to update the package manager by running <code>sudo apt-get update</code> and after that finishes running <code>sudo apt-get upgrade</code>. After both commands finish, install Samba packages by running <code>sudo apt-get install samba samba-common-bin</code> (You may get a message about changing the DHCP settings. You should be able to choose either option.)</p>
<p>Then create a new folder in your home directory to store shared files by running <code>mkdir /home/pi/shared</code>.</p>
<p>Now we need to set up Samba to share this folder over the network. First open the Samba configuration file by typing <code>sudo nano /etc/samba/smb.conf</code>. This will open the file in nano which is a command line text editor. Scroll to the bottom and add the following lines to the file.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">[CameraSTEMsShared]</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">path</span> = /home/pi/shared</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="va">writeable</span><span class="op">=</span>Yes</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="ex">create</span> mask=0777</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="ex">directory</span> mask=0777</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="va">public</span><span class="op">=</span>no</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Next, set up a new user for accessing the Samba share. Run <code>sudo smbpasswd -a pi</code> and then enter a password. This password can be distinct from your user password.</p>
<p>Finally, restart the samba service by running <code>sudo systemctl restart smbd</code>.</p>
<p>Now that configuration is done on the Pi, the final step is to set up access from your host.</p>
<ul>
<li>On Mac, go to Finder and navigate to <code>Go \&gt; Connect to Server</code>. Then connect to the server <code>smb://&lt;hostname_ip&gt;/CameraSTEMsShared</code> where <code>&lt;hostname_ip&gt;</code> is the IP address of your Pi. You can either use the <code>raspberrypi.local</code> dynamic address or find the current IP address of your Pi by running <code>hostname -I</code> on the Pi. Login with the username <code>pi</code> and the password you set for the samba share.</li>
<li>On Windows, open Explorer and click on the Computer tab at the top of the Window. On the top bar, click <code>Map network drive</code>. Then in the Folder path field, enter <code>\&lt;hostname_ip\&gt;\CameraSTEMsShared</code>. Make sure to tick <code>Connect using different credentials</code> so that it prompts you for the username and password you set up. When you enter your username, you’ll need to use a backslash before your user name (e.g.&nbsp;<code>\pi</code>) so that it does not try to login on the workspace of your host computer. After clicking <code>Finish</code> then enter your user details and click ok.</li>
</ul>
</section>
<section id="setting-up-python-virtual-environment" class="level3" data-number="2.8">
<h3 data-number="2.8" class="anchored" data-anchor-id="setting-up-python-virtual-environment"><span class="header-section-number">2.8</span> Setting up Python Virtual Environment</h3>
<p>In this section, you will set up a Python virtual environment. Virtual environments enable you to set up an isolated environment containing only specific packages and versions without requiring you to have these packages installed globally. This avoids conflicts and compatibility issues with different packages.</p>
<p>To set up the virtual environment, navigate to your /home/pi/shared directory and run ​​<code>python3 -m venv /home/pi/shared/.env</code>. This will create a new virtual environment and store the files within the folder <code>.env</code>. The dot preceding the folder name means that it is hidden which is helpful to avoid cluttering your terminal output. (Hint: you can see all files in a directory by running the list command ls with the -a flag which stands for all).</p>
<p>After creating your virtual environment, we need to activate it. To do this navigate to <code>/home/pi/shared</code> and then run <code>source .env/bin/activate</code>. This will run a shell script which will reconfigure your path variables to point to the version of Python and the packages installed in your environment as opposed to those installed on your system by default. After you activate the environment, you should see the name of the environment listed in parentheses at the left of the command prompt (e.g., (.env) in our case). To deactivate your virtual environment, enter <code>deactivate</code> at the command prompt.</p>
<p>To confirm that your virtual environment is working properly, deactivate the environment and run the command <code>which python3</code>. The <code>which</code> command returns the path where a command is located. This should return <code>/usr/bin/python3</code> which is the standard location for the Python binary on our system. Then, activate your virtual environment and run <code>which python3</code> again. Now you should see that the path to python3 is now changed to point to the version of python which is installed in our virtual environment.</p>
<div id="fig-venv-setup" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-venv-setup-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/venv-setup.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-venv-setup-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Virtual environment setup.
</figcaption>
</figure>
</div>
</section>
<section id="installing-the-camera" class="level3" data-number="2.9">
<h3 data-number="2.9" class="anchored" data-anchor-id="installing-the-camera"><span class="header-section-number">2.9</span> Installing the Camera</h3>
<section id="enable-camera-interface" class="level4" data-number="2.9.1">
<h4 data-number="2.9.1" class="anchored" data-anchor-id="enable-camera-interface"><span class="header-section-number">2.9.1</span> Enable Camera Interface</h4>
<p>By default the camera interface on your Pi may not be enabled. To make sure it is turned on, use the raspi-config utility to enable it. At the command prompt type <code>sudo raspi-config</code>. Then navigate to the <code>Interfacing Options</code> sub-menu and select the appropriate option to enable the camera. Then shutdown your Pi by running <code>sudo halt</code>, waiting a minute for the LED to turn off, and disconnecting it from the USB cable.</p>
</section>
<section id="connecting-the-camera-to-your-pi" class="level4" data-number="2.9.2">
<h4 data-number="2.9.2" class="anchored" data-anchor-id="connecting-the-camera-to-your-pi"><span class="header-section-number">2.9.2</span> Connecting the Camera to Your Pi</h4>
<p>Next, you will connect the Raspberry Pi NoIR camera module to your Pi. Take out the camera module and the camera cable. Then connect the small end of the cable to the camera interface on your Pi and the other wider end of the cable to your camera module. You may need to gently pull the black plastic parts of the receptacles on the Pi and the camera PCB so that you can insert the cable. Then insert the camera cable. Note that the orientation of the cable matters. On both sides, the contacts of the cable (i.e., the metal strips where the connection is made) should be oriented so that they face toward the PCBs. After you firmly seat the cable into the receptacle, gently push the black plastic piece in toward the connector to lock the ribbon cable in. Now your camera is connected and you are ready to take your first picture. Plug the power cable back in and boot your Pi up before continuing to the next section.</p>
</section>
</section>
<section id="take-your-first-picture" class="level3" data-number="2.10">
<h3 data-number="2.10" class="anchored" data-anchor-id="take-your-first-picture"><span class="header-section-number">2.10</span> Take Your First Picture</h3>
<p>In this section you will take your first image with your camera. We will be using the Python library picamera to control the Raspberry Pi camera and to capture and save images. In this section we will walk through how to install the package in your virtual environment and take your first picture!</p>
<section id="install-picamera" class="level4" data-number="2.10.1">
<h4 data-number="2.10.1" class="anchored" data-anchor-id="install-picamera"><span class="header-section-number">2.10.1</span> Install picamera</h4>
<p>Once you have your virtual environment set up, now we want to install the picamera library which will enable us to access and control our camera from Python. To do this, we’ll use the Python package manager <code>pip</code>. First, activate your environment. Then, run <code>pip3 list</code>. This will print out a list of all the packages installed in your environment. You should see a list of the default packages installed in our environment (probably just pip, pkg-resources, setuptools). To install picamera, run <code>pip3 install picamera</code> (Note: you can also use <code>pip</code> instead of <code>pip3</code> but it is safer to use <code>pip3</code> to ensure that the packages are installed for Python 3 instead of Python 2).</p>
<p>After running this command, run <code>pip3 list</code>. You should see that <code>picamera</code> has been added to the list of installed modules.</p>
</section>
<section id="take-your-first-image" class="level4" data-number="2.10.2">
<h4 data-number="2.10.2" class="anchored" data-anchor-id="take-your-first-image"><span class="header-section-number">2.10.2</span> Take Your First Image</h4>
<p>Now let’s use picamera to take an image. Open a new Python interpreter by running <code>python3</code>. Then import picamera by running <code>import picamera</code>. Then create a PiCamera object called cam by running <code>cam = picamera.PiCamera()</code>.</p>
<p>Now you can take an image using the <code>capture</code> method that is a member of the PiCamera class (and thus our PiCamera object <code>cam</code>). To save an image named <code>hello_raspberry.jpg</code> run <code>cam.capture(‘hello_raspberry.jpg’)</code>. In your host OS, navigate to the shared folder and you should see a new saved image file. Open it and check it out.</p>
<p>Now, of course you don’t want to have to manually type commands one by one at the command line. Create a new file (the easiest way to do this is to type <code>touch &lt;file_name&gt;</code> on your Pi). Then you can edit it either in the terminal using your favorite terminal text editor or by opening the file on your host OS via the mounted SMB shared network drive. Type the code below into a file called <code>save_image_to_file.py</code> and save it. Then run the script from the command line by running <code>python3 save_image_to_file.py</code>. You should see</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import libraries</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ex">from</span> time import sleep</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="ex">from</span> picamera import PiCamera</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create camera object</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="ex">cam</span> = PiCamera<span class="er">(</span><span class="kw">)</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Camera warm-up time</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sleep</span><span class="er">(</span><span class="ex">2</span><span class="kw">)</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="ex">print</span><span class="er">(</span><span class="st">"Camera is ready!"</span><span class="kw">)</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture the camera image and save it to disk</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="ex">cam.capture</span><span class="er">(</span><span class="st">'hello_raspberry.jpg'</span><span class="kw">)</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="ex">print</span><span class="er">(</span><span class="st">"Photo captured and saved."</span><span class="kw">)</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Close the camera object</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cam.close()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Code listing for save_image_to_file.py</p>
</section>
</section>
<section id="process-image-in-python" class="level3" data-number="2.11">
<h3 data-number="2.11" class="anchored" data-anchor-id="process-image-in-python"><span class="header-section-number">2.11</span> Process Image in Python</h3>
<p>Next we will load the image in Python to do some simple analysis and inspection. Since the Raspberry Pi has limited computational power compared to your host machine, it makes sense to do processing on your host OS. For this course we will do all of our programming in Python. You can use any Python environment that you would like (e.g., raw scripts run from terminal, PyCharm, IPython notebooks either locally or on Colab, etc.). In this section we will go through setting up Spyder which is a development environment for Python which features a very similar layout and feel to Matlab.</p>
<section id="download-spyder" class="level4" data-number="2.11.1">
<h4 data-number="2.11.1" class="anchored" data-anchor-id="download-spyder"><span class="header-section-number">2.11.1</span> Download Spyder</h4>
<p>First, navigate to the <a href="https://www.spyder-ide.org">website for Spyder</a> and download the installer. After installing the program, open it up. You will be presented with the home view. (Note: On macOS you may need to navigate to your Applications folder and launch Sypder by right clicking on it and clicking <code>Open</code> when opening it for the first time to get around the operating system’s gatekeeper functionality)</p>
</section>
</section>
</section>
<section id="image-acquisition-and-analysis-experiments" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="image-acquisition-and-analysis-experiments"><span class="header-section-number">3</span> Image Acquisition and Analysis Experiments</h2>
<p>After you have finished setting up the image acquisition and analysis pipeline, in this section you will use your system to run a few experiments to analyze different performance specifications of the Raspberry Pi Camera. The suggested workflow is to write your code on an editor on your host machine and then run it on your Pi via ssh. For example, you could create a new Python script saved in the directory shared via Samba. Then, on your Pi you can run the script from the command line (e.g., with by running <code>python3 \&lt;script_name\&gt;</code> in the shared directory) and save your data. Finally, you can then load the files on your host machine in Spyder to do the plotting and analysis required.</p>
<p>The following sections list a series of tasks for you to accomplish and submit in your lab writeup.</p>
<section id="image-with-scale-bar" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="image-with-scale-bar"><span class="header-section-number">3.1</span> Image with Scale Bar</h3>
<p>Take an image of an object and plot it in Python using matplotlib and the imshow function. In your plot, make sure to label the axes along with units, give your plot a descriptive title, and use a colorbar.</p>
<p>The recommended method for creating plots in Python is to use the subplots function to generate a figure and axes object which can be manipulated after it is created as shown in the example code snippet below.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt           <span class="co"># import matplotlib</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">1</span>)  <span class="co"># create subplots</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>im_data <span class="op">=</span> plt.imread(<span class="st">"test_image.jpg"</span>)    <span class="co"># load image</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>him <span class="op">=</span> ax.imshow(im_data)                  <span class="co"># plot image and save handle</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Whenever you are plotting images it is critical to visually indicating the scale of the objects in the photo. One way to do this is to directly calculate the magnification of the object and then use this information to convert pixel number to a physical length in the image. A simpler way is to measure the size in pixels of an object of known length in your image and use this to calculate the size of a pixel in your image in physical units of length such as meters or centimeters.</p>
<p>For your image, use something that is of known length in your image to calculate the le ngth of the object in pixels. Then, plot a rectangle on top of the image by creating a rectangle patch and adding it to your axis. See the link <a href="https://stackoverflow.com/questions/37435369/matplotlib-how-to-draw-a-rectangle-on-image">here</a> for an example. Then add text to your image above the scale bar to indicate its length. You may find the <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.text.html">documentation for the text function</a> provided in matplotlib helpful.</p>
<p>The image below provides an example of what an image with scale bar should look like.</p>
<div id="fig-example-image" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example-image-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/demo-image.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="205">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example-image-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: An example of a scale bar on a microscope image. From: <a href="https://doi.org/10.1038/s41566-017-0078-z">https://doi.org/10.1038/s41566-017-0078-z</a>
</figcaption>
</figure>
</div>
</section>
<section id="raw-bayer-image-capture" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="raw-bayer-image-capture"><span class="header-section-number">3.2</span> Raw Bayer Image Capture</h3>
<p>Color camera sensors are typically formed by putting an array of red, green, and blue filters over the monochrome pixels. A popular configuration is the <a href="https://en.wikipedia.org/wiki/Bayer_filter">Bayer color filter array</a> (CFA). In this section, you will take and save the raw Bayer data from the sensor. Read the PiCamera documentation <a href="https://picamera.readthedocs.io/en/release-1.13/api_array.html#picamera.array.PiBayerArray">here</a> on the PiBayerDataArray data structure and use it to capture a Bayer array and save to file. An easy way to save the data is to use the numpy function <a href="https://numpy.org/doc/stable/reference/generated/numpy.save.html">save</a> to save the raw data to an .npy file. Then the raw data can be reloaded on your host computer using the corresponding <a href="https://numpy.org/doc/stable/reference/generated/numpy.load.html#numpy.load">load</a> function in numpy.</p>
<p>In your analysis, plot each color channel of the image separately (e.g., separate plots for the red, green, and blue channels) and answer the following questions.</p>
<ol type="1">
<li>What is the size of the Bayer image data structure?</li>
<li>What does each dimension represent?</li>
<li>Which channel of your captured image is the brightest? Is this what you expect? Why or why not?</li>
</ol>
</section>
<section id="dark-noise-analysis" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="dark-noise-analysis"><span class="header-section-number">3.3</span> Dark Noise Analysis</h3>
<p>The dark noise value is the value of the image data captured when the sensor is covered (i.e., not exposed to light). Cover your sensor and capture a series of 10 dark frames and answer the following questions. Plot the average image (i.e., 2D image where each pixel is an average of its values across the frames). Then for the red channel of the image only answer the following questions.</p>
<ol type="1">
<li>What is the mean value of the red channel of your image sequence?</li>
<li>What is the standard deviation of this array of means calculated from your image sequence?</li>
</ol>
</section>
<section id="image-intensity-vs.-exposure-time" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="image-intensity-vs.-exposure-time"><span class="header-section-number">3.4</span> Image Intensity vs.&nbsp;Exposure Time</h3>
<p>Another important property of a camera is its linearity. In this section, you will take an exposure series and analyze how the average intensity of the sensor varies with exposure time. See the documentation <a href="https://picamera.readthedocs.io/en/release-1.13/recipes1.html#capturing-consistent-images">here</a> which will help provide information on how to take consistent images by disabling any automatic exposure compensation and directly setting the exposure time (called shutter_speed in picamera).</p>
<p>Uncover your sensor and take a set of images across a variety of exposure times. Take 10 images at each exposure time and vary the exposure time over three orders of magnitude (e.g., from 1 ms to 1 second) with at least 5 different exposure times. Then take the average of the images at each exposure time and the standard deviation of these average intensities. Then, plot the means vs.&nbsp;exposure time on a linear plot with error bars to indicate the standard deviation of the mean values calculated at each exposure time (hint: check out the <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.errorbar.html?highlight=errorbar#matplotlib.axes.Axes.errorbar">errorbar</a> plotting function in matplotlib). Fit the data with a line and report back both the slope of the line and its <span class="math inline">\(R^2\)</span> value. You may find <a href="https://www.geeksforgeeks.org/scipy-curve-fitting/">this tutorial</a> on curve fitting in Python helpful.</p>
</section>
</section>
<section id="faqs" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="faqs"><span class="header-section-number">4</span> FAQs</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Enabling virtual enviornment
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Run <code>source .env/bin/activate</code> to enable virtual environment and <code>deactivate</code> to disable.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Getting an error when trying to run a script
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Make sure you are running things on the right machine (host vs.&nbsp;Pi)</p>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>